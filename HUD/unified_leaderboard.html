<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Unified Leaderboard</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .summary-widget {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #111;
        color: #0ff;
        border: 1px solid #0ff;
        border-radius: 10px;
        box-shadow: 0 0 15px #0ff, inset 0 0 10px #0cc;
        padding: 15px;
        width: 250px;
        font-family: 'Orbitron', sans-serif;
        z-index: 1000;
    }
    .summary-widget h3 {
        margin: 0 0 10px;
        font-size: 1.1rem;
        text-align: center;
        text-shadow: 0 0 5px #0ff;
    }
    .summary-widget p {
        margin: 5px 0;
        font-size: 0.95rem;
    }
    
    .gold { background: linear-gradient(to right, #FFD700, #FFC300); color: #000; font-weight: bold; text-shadow: none; }
    .silver { background: linear-gradient(to right, #C0C0C0, #D3D3D3); color: #000; font-weight: bold; text-shadow: none; }
    .bronze { background: linear-gradient(to right, #CD7F32, #B87333); color: #000; font-weight: bold; text-shadow: none; }
    
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        background: #111;
        box-shadow: 0 0 10px #0ff;
    }
    th, td {
        padding: 10px;
        text-align: center;
    }
    th {
        background: #000;
        color: #0ff;
        text-shadow: 0 0 5px #0ff;
    }
    tr:nth-child(even) {
        background: #1a1a1a;
    }
    tr:hover {
        background: #0ff;
        color: #000;
        transition: background 0.3s ease;
    }
    caption {
        font-size: 1.3rem;
        font-weight: bold;
        padding: 10px;
        text-shadow: 0 0 10px #0ff;
    }
    
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap');
    body { font-family: 'Orbitron', sans-serif; background: #0a0a0a; color: #0ff; margin: 0; }
    header {
        background: #111;
        padding: 10px 20px;
        text-align: center;
        font-size: 1.5rem;
        text-shadow: 0 0 10px #0ff, 0 0 20px #0cc;
        box-shadow: 0 0 10px #0ff;
        border-bottom: 1px solid #0ff;
    }
    
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap');
    body { font-family: 'Orbitron', sans-serif; background: #0a0a0a; color: #0ff; }
    table {
        width: 100%;
        border-collapse: collapse;
        background: #111;
        box-shadow: 0 0 10px #0ff, 0 0 20px #0cc;
        margin-top: 20px;
    }
    th {
        background: #000;
        color: #0ff;
        padding: 10px;
        text-align: left;
        text-shadow: 0 0 5px #0ff;
        border-bottom: 2px solid #0ff;
    }
    td {
        padding: 8px 10px;
        border-bottom: 1px solid #222;
        color: #ccc;
    }
    tr:nth-child(even) { background: #1a1a1a; }
    tr:hover {
        background: #0ff;
        color: #000;
        transition: 0.3s;
    }
    caption {
        font-size: 1.2rem;
        font-weight: bold;
        text-shadow: 0 0 10px #0ff;
        padding: 10px;
    }
    
    body { background: #0f0f0f; color: #0ff; font-family: Arial, sans-serif; padding: 20px; }
    h1 { text-align: center; }
    .controls { text-align: center; margin-bottom: 20px; }
    .controls button, .controls select, .controls input {
      margin: 5px; padding: 8px 12px; border: none; border-radius: 5px; background: #0ff; color: #000; cursor: pointer;
    }
    .controls input { width: 200px; }
    .controls button:hover, .controls select:hover { background: #0cc; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #333; padding: 10px; text-align: center; }
    th { background: #111; color: #0ff; cursor: pointer; }
    tr:nth-child(even) { background: #222; }
    .highlight { background: #333 !important; color: #ff0; font-weight: bold; }
    #status { text-align: center; margin-top: 10px; font-size: 0.9rem; color: #0cc; }
    .pagination { text-align: center; margin-top: 15px; }
    .pagination button { margin: 0 5px; padding: 6px 12px; background: #0ff; color: #000; border: none; border-radius: 5px; cursor: pointer; }
    .pagination button.active { background: #0cc; font-weight: bold; }
  </style>
</head>
<body>

    <div class="search-filter-bar" style="margin: 10px 0; text-align: center;">
        <input type="text" id="search-player" placeholder="Search player..." style="padding: 8px; width: 200px; border: 1px solid #0ff; background: #000; color: #0ff; border-radius: 5px;" />
        <select id="filter-column" style="padding: 8px; margin-left: 10px; border: 1px solid #0ff; background: #000; color: #0ff; border-radius: 5px;">
            <option value="all">All Columns</option>
            <option value="name">Player Name</option>
            <option value="mega">Mega Hunt</option>
            <option value="super">Super Hunt</option>
            <option value="player">Player Hunt</option>
            <option value="tournament">Tournament</option>
            <option value="lucky7">Lucky 7</option>
        </select>
    </div>
    
<header>Unified Leaderboard</header>
  <h1>Unified Leaderboard</h1>

  <div class="controls">
    <input type="text" id="search-box" placeholder="Search player..." onkeyup="searchPlayer()" />
    <button onclick="filterTopPlayers(3)">Top 3</button>
    <button onclick="filterTopPlayers(10)">Top 10</button>
    <button onclick="resetFilter()">Show All</button>
    <select id="category-sort" onchange="sortByCategory()">
      <option value="total">Sort by Total</option>
      <option value="hunts">Sort by Hunts</option>
      <option value="tournaments">Sort by Tournaments</option>
      <option value="lucky7">Sort by Lucky 7</option>
    </select>
  </div>

  <p id="status">Loading leaderboard data...</p>
  <table id="leaderboard-table">
    <thead>
      <tr>
        <th onclick="sortBy('rank')">Rank</th>
        <th onclick="sortBy('username')">Username</th>
        <th onclick="sortBy('hunts')">Hunts</th>
        <th onclick="sortBy('tournaments')">Tournaments</th>
        <th onclick="sortBy('lucky7')">Lucky 7</th>
        <th onclick="sortBy('total')">Total</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <div class="pagination" id="pagination"></div>

  <script>
    let leaderboardData = JSON.parse(localStorage.getItem("unifiedLeaderboard")) || []
    let leaderboardData = [];
    let currentPage = 1;
    const rowsPerPage = 10;

    function fetchLeaderboard() {
      document.getElementById('status').innerText = "Loading data...";
      leaderboardData = JSON.parse(localStorage.getItem("unifiedLeaderboard")) || [];
      renderTable(leaderboardData);
      setupPagination();
      document.getElementById('status').innerText = "âœ… Leaderboard loaded from Admin Master Panel.";
    }

    function renderTable(data) {
      const tbody = document.getElementById('leaderboard-table').querySelector('tbody');
      tbody.innerHTML = '';
      const start = (currentPage - 1) * rowsPerPage;
      const end = start + rowsPerPage;
      const paginatedData = data.slice(start, end);

      paginatedData.forEach((entry, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${start + index + 1}</td>
          <td>${entry.username}</td>
          <td>${entry.hunts}</td>
          <td>${entry.tournaments}</td>
          <td>${entry.lucky7}</td>
          <td>${entry.total}</td>
        `;
        tbody.appendChild(row);
      });
    }

    function setupPagination() {
      const pagination = document.getElementById('pagination');
      pagination.innerHTML = '';
      const totalPages = Math.ceil(leaderboardData.length / rowsPerPage);
      for (let i = 1; i <= totalPages; i++) {
        const button = document.createElement('button');
        button.textContent = i;
        if (i === currentPage) button.classList.add('active');
        button.addEventListener('click', () => {
          currentPage = i;
          renderTable(leaderboardData);
          setupPagination();
        });
        pagination.appendChild(button);
      }
    }

    function filterTopPlayers(limit) {
      const topPlayers = leaderboardData.slice(0, limit);
      currentPage = 1;
      renderTable(topPlayers);
      document.getElementById('pagination').innerHTML = '';
    }

    function resetFilter() {
      currentPage = 1;
      renderTable(leaderboardData);
      setupPagination();
    }

    function sortByCategory() {
      const category = document.getElementById('category-sort').value;
      sortBy(category);
    }

    function sortBy(field) {
      leaderboardData.sort((a, b) => {
        if (field === 'username') {
          return a.username.localeCompare(b.username);
        } else {
          return (b[field] || 0) - (a[field] || 0);
        }
      });
      currentPage = 1;
      renderTable(leaderboardData);
      setupPagination();
    }

    function searchPlayer() {
      const query = document.getElementById('search-box').value.toLowerCase();
      const rows = document.querySelectorAll('#leaderboard-table tbody tr');
      rows.forEach(row => {
        row.classList.remove('highlight');
        const username = row.cells[1].innerText.toLowerCase();
        if (username.includes(query) && query !== '') {
          row.classList.add('highlight');
        }
      });
    }

    fetchLeaderboard();
    setInterval(fetchLeaderboard, 30000);
  </script>

    <script>
    function highlightTop3() {
        const rows = document.querySelectorAll('table tbody tr');
        rows.forEach((row, index) => {
            row.classList.remove('gold', 'silver', 'bronze');
            if (index === 0) row.classList.add('gold');
            else if (index === 1) row.classList.add('silver');
            else if (index === 2) row.classList.add('bronze');
        });
    }
    document.addEventListener('DOMContentLoaded', highlightTop3);
    </script>

    <script>
    function updateSummary() {
        const rows = document.querySelectorAll('table tbody tr');
        const totalPlayers = rows.length;
        document.getElementById('total-players').innerText = 'Total Players: ' + totalPlayers;

        if (rows.length > 0) {
            const topRow = rows[0];
            const topName = topRow.cells[0].innerText;
            const topScore = topRow.cells[topRow.cells.length - 1].innerText;
            document.getElementById('top-player').innerText = 'Top Player: ' + topName;
            document.getElementById('top-score').innerText = 'Top Score: ' + topScore;
        }
    }
    document.addEventListener('DOMContentLoaded', () => {
        updateSummary();
        highlightTop3();  // Ensure Top 3 highlighting still works
    });
    </script>
    
    <script>
    function filterLeaderboard() {
        const input = document.getElementById('search-player').value.toLowerCase();
        const filterColumn = document.getElementById('filter-column').value;
        const rows = document.querySelectorAll('table tbody tr');

        rows.forEach(row => {
            let textContent = '';
            if (filterColumn === 'all') {
                textContent = row.innerText.toLowerCase();
            } else {
                const columns = {
                    'name': 0,
                    'mega': 1,
                    'super': 2,
                    'player': 3,
                    'tournament': 4,
                    'lucky7': 5
                };
                const index = columns[filterColumn];
                if (index !== undefined && row.cells[index]) {
                    textContent = row.cells[index].innerText.toLowerCase();
                }
            }
            row.style.display = textContent.includes(input) ? '' : 'none';
        });
    }

    document.getElementById('search-player').addEventListener('keyup', filterLeaderboard);
    document.getElementById('filter-column').addEventListener('change', filterLeaderboard);
    </script>
    
    <script>
    function refreshLeaderboard() {
      // This is a placeholder - full refresh logic can be implemented when needed
      console.log('Leaderboard refreshed due to Admin update.');
      highlightTop3();
      updateSummary();
    }
    window.addEventListener('storage', refreshLeaderboard);
    </script>
</body>
    
    
</html>
